; PIC16F628A Configuration Bit Settings
; ASM source line config statements
#include "p16F628A.inc"

; CONFIG
; __config 0xFF19
 __CONFIG _FOSC_INTOSCCLK & _WDTE_OFF & _PWRTE_OFF & _MCLRE_OFF & _BOREN_OFF & _LVP_OFF & _CPD_OFF & _CP_OFF

iCount	EQU	d'227'

	ORG	0x0000
	GOTO	setup

	ORG	0x0004
	BTFSC	INTCON, INTF
	call	button
	RETFIE

button:
	BCF	INTCON, INTF
	MOVF	TMR0
	MOVWF	INDF
	INCF	FSR
	RETURN

send:
	MOVLW	h'20'
	MOVWF	FSR
	RETURN

setup:
	CLRF	PORTA
	CLRF	PORTB
	BANKSEL CMCON
	MOVLW	0x7
	MOVWF	CMCON

	BANKSEL	TRISA
	CLRF	TRISA
	BSF	TRISB, RB0

	BANKSEL	OPTION_REG
	MOVLW	b'11010011'
	MOVWF	OPTION_REG
	BCF	PCON, OSCF

	MOVLW	b'10110000'
	MOVWF	INTCON

	BANKSEL	PORTA

	MOVLW	h'20'
	MOVWF	FSR

main:
	MOVLW	h'22'
	SUBWF	FSR, W
	BTFSC	STATUS, Z
	CALL	send
	GOTO	main

	END



